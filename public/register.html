<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inscription - Youth Green Tech</title>
  <meta name="description" content="Inscription membre - Youth Green Tech" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75' fill='%2327ae60'>‚úì</text></svg>" />
  
  <!-- Styles -->
  <link rel="stylesheet" href="css/style.min.css" />
  <link rel="stylesheet" href="css/auth.css" />
</head>
<body>
  <!-- Header -->
  <header class="site-header">
    <div class="container">
      <div class="header-inner">
        <a href="index.html" class="brand">
          <span class="logo-icon">‚úì</span> Youth Green Tech
        </a>
        <nav class="site-nav" id="site-nav">
          <ul>
            <li><a href="index.html">Accueil</a></li>
            <li><a href="login.html" class="cta-link">Connexion</a></li>
          </ul>
        </nav>
        <button class="nav-toggle" aria-expanded="false" aria-label="Menu de navigation">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="auth-page">
    <section class="auth-container">
      <div class="auth-box">
        <h1>Inscription</h1>
        <p class="auth-subtitle">Rejoignez notre communaut√© verte</p>

        <!-- Error Message -->
        <div id="errorMessage" class="auth-message error-message" role="alert" aria-live="assertive" style="display: none;">
          <span class="message-icon">‚ö†Ô∏è</span>
          <span id="errorText"></span>
        </div>

        <!-- Success Message -->
        <div id="successMessage" class="auth-message success-message" role="alert" aria-live="polite" style="display: none;">
          <span class="message-icon">‚úÖ</span>
          <span id="successText"></span>
        </div>

        <!-- Registration Form -->
        <form id="registerForm" class="auth-form" aria-label="Formulaire d'inscription">
          <div class="form-group">
            <label for="displayName">Nom complet <span class="required">*</span></label>
            <input
              id="displayName"
              type="text"
              required
              aria-required="true"
              placeholder="Votre nom"
              minlength="2"
              maxlength="100"
            />
            <small class="form-hint">Au moins 2 caract√®res</small>
          </div>

          <div class="form-group">
            <label for="email">Email <span class="required">*</span></label>
            <input
              id="email"
              type="email"
              required
              aria-required="true"
              placeholder="vous@exemple.com"
              maxlength="255"
            />
            <small class="form-hint">Nous ne partageons jamais votre email</small>
          </div>

          <div class="form-group">
            <label for="password">Mot de passe <span class="required">*</span></label>
            <input
              id="password"
              type="password"
              required
              aria-required="true"
              placeholder="Minimum 8 caract√®res"
              minlength="8"
            />
            <small class="form-hint">
              Au moins 8 caract√®res : majuscule, minuscule, chiffre
            </small>
            <div class="password-strength">
              <div id="strengthBar" class="strength-bar"></div>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">Confirmer le mot de passe <span class="required">*</span></label>
            <input
              id="confirmPassword"
              type="password"
              required
              aria-required="true"
              placeholder="Confirmez votre mot de passe"
            />
          </div>

          <div class="form-group checkbox">
            <input
              id="interests"
              type="checkbox"
              value="innovation"
            />
            <label for="interests">
              Je suis int√©ress√© par les innovations en technologie verte
            </label>
          </div>

          <div class="form-group checkbox">
            <input
              id="terms"
              type="checkbox"
              required
              aria-required="true"
            />
            <label for="terms">
              J'accepte les <a href="#" target="_blank">conditions d'utilisation</a> <span class="required">*</span>
            </label>
          </div>

          <button type="submit" class="btn primary btn-submit" aria-label="S'inscrire">
            S'inscrire
          </button>

          <p class="auth-footer">
            D√©j√† membre? <a href="login.html">Se connecter</a>
          </p>
        </form>
      </div>

      <!-- Benefits Column -->
      <div class="auth-benefits">
        <h2>Pourquoi rejoindre?</h2>
        <ul class="benefits-list">
          <li>
            <span class="benefit-icon">üå±</span>
            <h3>Acc√®s aux activit√©s</h3>
            <p>Participez √† nos √©v√©nements et formations exclusifs</p>
          </li>
          <li>
            <span class="benefit-icon">üí°</span>
            <h3>R√©seau professionnel</h3>
            <p>Connectez-vous avec des passionn√©s de technologie verte</p>
          </li>
          <li>
            <span class="benefit-icon">üìä</span>
            <h3>Ressources premium</h3>
            <p>Acc√©dez √† nos guides et outils pour la transition verte</p>
          </li>
          <li>
            <span class="benefit-icon">üéØ</span>
            <h3>Certifications</h3>
            <p>Obtenez des certifications reconnues en technologie durable</p>
          </li>
        </ul>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="container">
      <div class="footer-inner">
        <div class="footer-left">
          <p>&copy; <span id="year"></span> Youth Green Tech. Tous droits r√©serv√©s.</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <!-- bcrypt.js for password hashing (from CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js"></script>
  
  <!-- Members manager -->
  <script src="js/members.js"></script>

  <!-- Page script -->
  <script>
    // Redirect if already logged in
    if (auth.isLoggedIn()) {
      window.location.href = 'dashboard.html';
    }

    const form = document.getElementById('registerForm');
    const errorMsg = document.getElementById('errorMessage');
    const successMsg = document.getElementById('successMessage');
    const errorText = document.getElementById('errorText');
    const successText = document.getElementById('successText');
    const strengthBar = document.getElementById('strengthBar');
    const passwordInput = document.getElementById('password');

    // Update year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Mobile nav
    const navToggle = document.querySelector('.nav-toggle');
    const siteNav = document.getElementById('site-nav');
    navToggle.addEventListener('click', () => {
      const expanded = navToggle.getAttribute('aria-expanded') === 'true';
      navToggle.setAttribute('aria-expanded', String(!expanded));
      siteNav.classList.toggle('open');
    });

    // Close mobile nav on link click
    document.querySelectorAll('#site-nav a').forEach(link => {
      link.addEventListener('click', () => {
        navToggle.setAttribute('aria-expanded', 'false');
        siteNav.classList.remove('open');
      });
    });

    // Password strength indicator
    passwordInput.addEventListener('input', function() {
      const password = this.value;
      let strength = 0;

      if (password.length >= 8) strength += 25;
      if (password.length >= 12) strength += 25;
      if (/[A-Z]/.test(password) && /[a-z]/.test(password)) strength += 25;
      if (/\d/.test(password)) strength += 25;

      strengthBar.style.width = strength + '%';
      
      if (strength < 50) {
        strengthBar.style.backgroundColor = '#e74c3c';
      } else if (strength < 75) {
        strengthBar.style.backgroundColor = '#f39c12';
      } else {
        strengthBar.style.backgroundColor = '#27ae60';
      }
    });

    // Form submission
    form.addEventListener('submit', async function(e) {
      e.preventDefault();

      // Hide previous messages
      errorMsg.style.display = 'none';
      successMsg.style.display = 'none';

      const displayName = document.getElementById('displayName').value.trim();
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      const termsAccepted = document.getElementById('terms').checked;
      const interests = document.getElementById('interests').checked ? ['innovation'] : [];

      // Validation
      if (!displayName || !email || !password || !confirmPassword) {
        showError('Tous les champs sont obligatoires');
        return;
      }

      if (password !== confirmPassword) {
        showError('Les mots de passe ne correspondent pas');
        return;
      }

      if (!termsAccepted) {
        showError('Vous devez accepter les conditions d\'utilisation');
        return;
      }

      // Disable button
      const submitBtn = form.querySelector('button[type="submit"]');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Inscription en cours...';

      // Register user
      const result = await auth.registerUser(email, password, displayName, interests);

      if (result.success) {
        showSuccess(result.message);
        form.reset();
        strengthBar.style.width = '0%';
        
        // Redirect to login after 2 seconds
        setTimeout(() => {
          window.location.href = 'login.html';
        }, 2000);
      } else {
        showError(result.message);
        submitBtn.disabled = false;
        submitBtn.textContent = 'S\'inscrire';
      }
    });

    function showError(message) {
      errorText.textContent = message;
      errorMsg.style.display = 'block';
      errorMsg.classList.add('shake');
      setTimeout(() => errorMsg.classList.remove('shake'), 500);
    }

    function showSuccess(message) {
      successText.textContent = message;
      successMsg.style.display = 'block';
      successMsg.classList.add('fade-in');
      setTimeout(() => successMsg.classList.remove('fade-in'), 500);
    }

    // Smooth scroll for internal links
    document.querySelectorAll('a[href^="#"]').forEach(link => {
      link.addEventListener('click', (e) => {
        const href = link.getAttribute('href');
        if (href.length > 1) {
          e.preventDefault();
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
        }
      });
    });
  </script>
</body>
</html>
